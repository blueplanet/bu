%table
  - @events.each do |event|
    %tr
      %td *
      %td= month_day(event.started_at)
      %td== (#{hour_min(event.started_at)})
      - unless controller_name == 'groups'
        %td= link_to to_short(event.group.name, 9, 2), event.group
      %td.bold= link_to to_short(event.title, 16, 2), event

      - if @user.nil?
      - else
        - atnd = @user.atnd(event)
        - if atnd
          %td.atnd=_ atnd.state.capitalize
        - else
          %td=_'Unknown'

        - if event.ended?
          %td.gray=_'ended'
        - elsif atnd
          %td.update= link_to _('cancel'), event_path(event, 'delete')
        - elsif event.group.member?(@user)
          %td.update.atnd
            = link_to _('attend'), event_path(event, 'attend')
            = link_to _('absent'), event_path(event, 'absent')
            = link_to _('maybe'),  event_path(event, 'maybe')
